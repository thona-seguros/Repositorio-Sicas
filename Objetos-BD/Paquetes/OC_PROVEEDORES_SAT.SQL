--
-- OC_PROVEEDORES_SAT  (Package) 
--
--  Dependencies: 
--   STANDARD (Package)
--   STANDARD (Package)
--   DBMS_OUTPUT (Synonym)
--   PROVEEDORES_SAT (Table)
--   PROVEEDORES_SAT_DEFINITIVOS (Table)
--   PROVEEDORES_SAT_PRESUNTOS (Table)
--
CREATE OR REPLACE PACKAGE SICAS_OC.OC_PROVEEDORES_SAT IS

  FUNCTION ES_PROVEEDOR_SAT(nCodCia NUMBER, cNumDocIdentEmp VARCHAR2) RETURN VARCHAR2;
  FUNCTION ES_PROVEEDOR_SAT_DEFINITIVO(nCodCia NUMBER, cNumDocIdentEmp VARCHAR2) RETURN VARCHAR2;  
  FUNCTION ES_PROVEEDOR_SAT_PRESUNTOS(nCodCia NUMBER, cNumDocIdentEmp VARCHAR2) RETURN VARCHAR2;  

END OC_PROVEEDORES_SAT;
/

--
-- OC_PROVEEDORES_SAT  (Package Body) 
--
--  Dependencies: 
--   OC_PROVEEDORES_SAT (Package)
--
CREATE OR REPLACE PACKAGE BODY SICAS_OC.OC_PROVEEDORES_SAT IS

FUNCTION ES_PROVEEDOR_SAT(nCodCia NUMBER, cNumDocIdentEmp VARCHAR2) RETURN VARCHAR2 IS
cEsProveedor     VARCHAR2(1);
BEGIN
   BEGIN
      SELECT 'S'
        INTO cEsProveedor
        FROM PROVEEDORES_SAT
       WHERE CODCIA           = nCodCia
         AND ID_RFC           = cNumDocIdentEmp
         AND ESTATUS_REGISTRO = 'ACT';
   EXCEPTION
      WHEN NO_DATA_FOUND THEN
         cEsProveedor := 'N';
      WHEN TOO_MANY_ROWS THEN
         cEsProveedor := 'S';
   END;

   RETURN(cEsProveedor);
END ES_PROVEEDOR_SAT;

FUNCTION ES_PROVEEDOR_SAT_DEFINITIVO(nCodCia NUMBER, cNumDocIdentEmp VARCHAR2) RETURN VARCHAR2 IS
cEsProveedor     VARCHAR2(1);
BEGIN
   BEGIN
      SELECT 'S'
        INTO cEsProveedor
        FROM PROVEEDORES_SAT_DEFINITIVOS
       WHERE CODCIA           = nCodCia
         AND ID_RFC           = cNumDocIdentEmp
         AND ESTATUS_REGISTRO IS NULL;
   EXCEPTION
      WHEN NO_DATA_FOUND THEN
         cEsProveedor := 'N';
      WHEN TOO_MANY_ROWS THEN
         cEsProveedor := 'S';
   END;
   DBMS_OUTPUT.put_line('EN PROVEEDORES SAT DEFINITIVOS cEsProveedor : '|| cEsProveedor);
   RETURN(cEsProveedor);
END ES_PROVEEDOR_SAT_DEFINITIVO;
FUNCTION ES_PROVEEDOR_SAT_PRESUNTOS(nCodCia NUMBER, cNumDocIdentEmp VARCHAR2) RETURN VARCHAR2 IS
cEsProveedor     VARCHAR2(1);
BEGIN
   BEGIN
      SELECT 'S'
        INTO cEsProveedor
        FROM PROVEEDORES_SAT_PRESUNTOS
       WHERE CODCIA           = nCodCia
         AND ID_RFC           = cNumDocIdentEmp
         AND ESTATUS_REGISTRO IS NULL;
   EXCEPTION
      WHEN NO_DATA_FOUND THEN
         cEsProveedor := 'N';
      WHEN TOO_MANY_ROWS THEN
         cEsProveedor := 'S';
   END;
   DBMS_OUTPUT.put_line('EN PROVEEDORES SAT PRESUNTOS cEsProveedor : '|| cEsProveedor);
   RETURN(cEsProveedor);
END ES_PROVEEDOR_SAT_PRESUNTOS;
END OC_PROVEEDORES_SAT;
/

--
-- OC_PROVEEDORES_SAT  (Synonym) 
--
--  Dependencies: 
--   OC_PROVEEDORES_SAT (Package)
--
CREATE OR REPLACE PUBLIC SYNONYM OC_PROVEEDORES_SAT FOR SICAS_OC.OC_PROVEEDORES_SAT
/


GRANT EXECUTE ON SICAS_OC.OC_PROVEEDORES_SAT TO PUBLIC
/
