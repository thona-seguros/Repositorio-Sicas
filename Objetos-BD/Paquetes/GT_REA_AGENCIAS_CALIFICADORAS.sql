CREATE OR REPLACE PACKAGE GT_REA_AGENCIAS_CALIFICADORAS IS

  PROCEDURE ACTIVAR_AGENCIA(nCodCia NUMBER, cCodAgencia VARCHAR2);
  PROCEDURE SUSPENDER_AGENCIA(nCodCia NUMBER, cCodAgencia VARCHAR2);
  FUNCTION NOMBRE_AGENCIA(nCodCia NUMBER, cCodAgencia VARCHAR2) RETURN VARCHAR2;

END GT_REA_AGENCIAS_CALIFICADORAS;
/

CREATE OR REPLACE PACKAGE BODY GT_REA_AGENCIAS_CALIFICADORAS IS

PROCEDURE ACTIVAR_AGENCIA(nCodCia NUMBER, cCodAgencia VARCHAR2) IS
BEGIN
   UPDATE REA_AGENCIAS_CALIFICADORAS
      SET StsAgencia = 'ACTIVA',
          FecSts     = TRUNC(SYSDATE)
    WHERE CodCia     = nCodCia
      AND CodAgencia = cCodAgencia;
END ACTIVAR_AGENCIA;

PROCEDURE SUSPENDER_AGENCIA(nCodCia NUMBER, cCodAgencia VARCHAR2) IS
BEGIN
   UPDATE REA_AGENCIAS_CALIFICADORAS
      SET StsAgencia = 'SUSPEN',
          FecSts     = TRUNC(SYSDATE)
    WHERE CodCia     = nCodCia
      AND CodAgencia = cCodAgencia;
END SUSPENDER_AGENCIA;

FUNCTION NOMBRE_AGENCIA(nCodCia NUMBER, cCodAgencia VARCHAR2) RETURN VARCHAR2 IS
cNomAgencia       REA_AGENCIAS_CALIFICADORAS.NomAgencia%TYPE;
BEGIN
   BEGIN
      SELECT NomAgencia
        INTO cNomAgencia
        FROM REA_AGENCIAS_CALIFICADORAS
       WHERE CodCia     = nCodCia
         AND CodAgencia = cCodAgencia;
   EXCEPTION
      WHEN NO_DATA_FOUND THEN
         cNomAgencia := 'Agencia - NO EXISTE';
   END;
   RETURN(cNomAgencia);
END NOMBRE_AGENCIA;

END GT_REA_AGENCIAS_CALIFICADORAS;
